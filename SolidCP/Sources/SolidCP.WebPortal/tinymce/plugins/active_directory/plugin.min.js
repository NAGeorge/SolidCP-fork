tinymce.PluginManager.add('active_directory', function(editor) {
    // Add a button that opens a window
    editor.addButton('active_directory', {
        type: 'menubutton',
        text: 'Active Directory Fields',
        contextmenu: false,
        icon: 'settings',
        menu: [
			{ text: 'First Name',           onclick: function() {editor.insertContent('%%FirstName%%');} },
			{ text: 'Middle Initial',       onclick: function() {editor.insertContent('%%Initials%%');} }, 
			{ text: 'Last Name',            onclick: function() {editor.insertContent('%%LastName%%');} }, 
			{ text: 'Display Name',         onclick: function() {editor.insertContent('%%DisplayName%%');} }, 
			{ text: 'Email',                onclick: function() {editor.insertContent('%%Email%%');} }, 
			{ text: 'Notes',                onclick: function() {editor.insertContent('%%Notes%%');} },
			{ text: '-' },
			{ text: 'Job Title',            onclick: function() {editor.insertContent('%%Title%%');} }, 
			{ text: 'Company Name',         onclick: function() {editor.insertContent('%%Company%%');} }, 
			{ text: 'Department',           onclick: function() {editor.insertContent('%%Department%%');} }, 
			{ text: 'Office',               onclick: function() {editor.insertContent('%%Office%%');} }, 
			{ text: 'Manager',              onclick: function() {editor.insertContent('%%Manager%%');} },
			{ text: '-' },
			{ text: 'Phone Number',         onclick: function() {editor.insertContent('%%PhoneNumber%%');} }, 
			{ text: 'Fax Number',           onclick: function() {editor.insertContent('%%FaxNumber%%');} }, 
			{ text: 'Mobile Number',        onclick: function() {editor.insertContent('%%MobileNumber%%');} }, 
			{ text: 'Home Phone Number',    onclick: function() {editor.insertContent('%%HomePhoneNumber%%');} }, 
			{ text: 'Pager Number',         onclick: function() {editor.insertContent('%%PagerNumber%%'); } },
            { text: 'Web Page',             onclick: function() {editor.insertContent('%%wWWHomePage%%'); } },
			{ text: '-' },
			{ text: 'Address',              onclick: function() {editor.insertContent('%%StreetAddress%%');} }, 
			{ text: 'City',                 onclick: function() {editor.insertContent('%%City%%');} }, 
			{ text: 'State / Province',     onclick: function() {editor.insertContent('%%State%%');} }, 
			{ text: 'Post Code / Zip Code', onclick: function() {editor.insertContent('%%PostalCode%%');} }, 
			{ text: 'Country',              onclick: function() {editor.insertContent('%%Country%%');} }
		]
	}),
	editor.addMenuItem("active_directory", {
		text: "Active Directory Fields",
		context: "active_directory",
        icon: 'settings',
        menu: [
			{ text: 'First Name',           onclick: function() {editor.insertContent('%%FirstName%%');} },
			{ text: 'Middle Initial',       onclick: function() {editor.insertContent('%%Initials%%');} }, 
			{ text: 'Last Name',            onclick: function() {editor.insertContent('%%LastName%%');} }, 
			{ text: 'Display Name',         onclick: function() {editor.insertContent('%%DisplayName%%');} }, 
			{ text: 'Email',                onclick: function() {editor.insertContent('%%Email%%');} }, 
			{ text: 'Notes',                onclick: function() {editor.insertContent('%%Notes%%');} },
			{ text: '-' },
			{ text: 'Job Title',            onclick: function() {editor.insertContent('%%Title%%');} }, 
			{ text: 'Company Name',         onclick: function() {editor.insertContent('%%Company%%');} }, 
			{ text: 'Department',           onclick: function() {editor.insertContent('%%Department%%');} }, 
			{ text: 'Office',               onclick: function() {editor.insertContent('%%Office%%');} }, 
			{ text: 'Manager',              onclick: function() {editor.insertContent('%%Manager%%');} },
			{ text: '-' },
			{ text: 'Phone Number',         onclick: function() {editor.insertContent('%%PhoneNumber%%');} }, 
			{ text: 'Fax Number',           onclick: function() {editor.insertContent('%%FaxNumber%%');} }, 
			{ text: 'Mobile Number',        onclick: function() {editor.insertContent('%%MobileNumber%%');} }, 
			{ text: 'Home Phone Number',    onclick: function() {editor.insertContent('%%HomePhoneNumber%%');} }, 
			{ text: 'Pager Number',         onclick: function() {editor.insertContent('%%PagerNumber%%');} },
			{ text: '-' },
			{ text: 'Address',              onclick: function() {editor.insertContent('%%StreetAddress%%');} }, 
			{ text: 'City',                 onclick: function() {editor.insertContent('%%City%%');} }, 
			{ text: 'State / Province',     onclick: function() {editor.insertContent('%%State%%');} }, 
			{ text: 'Post Code / Zip Code', onclick: function() {editor.insertContent('%%PostalCode%%');} }, 
			{ text: 'Country',              onclick: function() {editor.insertContent('%%Country%%');} }
		]
	})

});
